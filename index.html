<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>🌐 Live Traffic Monitor - DDoS Mitigation</title>
  <style>
    body { font-family: Arial; background: #181818; color: white; text-align: center; }
    h1 { margin-top: 20px; }
    canvas { background: #222; border-radius: 10px; padding: 10px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>🌐 Live Traffic Monitor</h1>
  <p>DDoS Mitigation</p>
  <canvas id="rpsChart" width="600" height="300"></canvas>

  <script>
    const workerUrl = "https://worker.hcydgt.workers.dev";
    const ctx = document.getElementById('rpsChart').getContext('2d');

    let chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Requests Per Second (RPS)',
          data: [],
          borderColor: 'lime',
          backgroundColor: 'rgba(0,255,0,0.1)',
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: { ticks: { color: 'white' } },
          y: { ticks: { color: 'white' } }
        },
        plugins: { legend: { labels: { color: 'white' } } }
      }
    });

    // Kirim hit ke Worker setiap halaman di-load
    fetch(workerUrl).catch(() => {});

    // Update data setiap detik
    setInterval(() => {
      fetch(workerUrl + "/stats")
        .then(res => res.json())
        .then(data => {
          let time = new Date().toLocaleTimeString();
          chart.data.labels.push(time);
          chart.data.datasets[0].data.push(data.rps);
          if (chart.data.labels.length > 20) {
            chart.data.labels.shift();
            chart.data.datasets[0].data.shift();
          }
          chart.update();
        })
        .catch(() => {});
    }, 1000);
  </script>
</body>
</html>
